<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Theory &mdash; AMP 1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="AMP 1 documentation" href="index.html" />
    <link rel="next" title="Parallel Computing" href="parallelcomputing.html" />
    <link rel="prev" title="How to use Amp?" href="useamp.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="parallelcomputing.html" title="Parallel Computing"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="useamp.html" title="How to use Amp?"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">AMP 1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="theory">
<span id="id1"></span><h1>Theory<a class="headerlink" href="#theory" title="Permalink to this headline">¶</a></h1>
<p>According to Born-Oppenheimer approximation, the potential energy of an atomic configuration
can be assumed as a function of only nuclei positions. Potential energy is in general a very
complicated function that in theory can be found by directly solving the Schrodinger
equation. However, in practice, exact analytical solution to the many-body Schrodinger
equation is very difficult (if not impossible). Taking into account this fact, the idea is
then to approximate the potential energy with a regression method:</p>
<div class="math">
\[\textbf{R}\xrightarrow{\text{regression}}E=E(\textbf{R}),\]</div>
<p>where <span class="math">\(\textbf{R}\)</span> is the position of atoms in the system.</p>
<div class="section" id="atomic-representation-of-potential-energy">
<h2>Atomic representation of potential energy<a class="headerlink" href="#atomic-representation-of-potential-energy" title="Permalink to this headline">¶</a></h2>
<p>In order to have a potential function which is simultaneously applicable to systems of
different sizes, the total potential energy of the system can to be broken up into atomic
energy contributions:</p>
<div class="math">
\[E(\textbf{R})=\sum_{\text{atom}=1}^{N}E_\text{atom}(\textbf{R}).\]</div>
<p>The above expansion can be justified by assembling the atomic configuration by bringing
atoms close to each other one by one. Then the atomic energy contributions can be
approximated using a regression method:</p>
<div class="math">
\[\textbf{R}\xrightarrow{\text{regression}}E_\text{atom}=E_\text{atom}\left(\textbf{R}\right).\]</div>
</div>
<div class="section" id="descriptor">
<h2>Descriptor<a class="headerlink" href="#descriptor" title="Permalink to this headline">¶</a></h2>
<p>A better interpolation can be achieved if an appropriate symmetry function <span class="math">\(\textbf{G}\)</span>
of atomic coordinates, representing the functional dependence of local energetics, is used
as the input of regression operator:</p>
<div class="math">
\[\textbf{R}\xrightarrow{\textbf{G}}\textbf{G}\left(\textbf{R}\right)\xrightarrow{\text{regression}}E_\text{atom}=E_\text{atom}\left(\textbf{G}\left(\textbf{R}\right)\right).\]</div>
<div class="section" id="behler">
<h3>Behler<a class="headerlink" href="#behler" title="Permalink to this headline">¶</a></h3>
<p>Currently, only symmetry function <span class="math">\(\textbf{G}\)</span> as suggested by Behler [1] as a function
of pair-atom distances and three-atom angles, is implemented within Amp. Further local
environment descriptors are planned to be implemented in the near future. Radial symmetry
function of Behler type captures interaction of atom <span class="math">\(i\)</span> with all atoms <span class="math">\(j\)</span> as
the sum of Gaussians with width <span class="math">\(\eta\)</span> and center <span class="math">\(R_s\)</span>,</p>
<div class="math">
\[\begin{split}{}^{1}G^{(i)}=\sum^{\tiny{\begin{array}{c} \text{atoms j within }R_c\\
\text{ distance of atom i}
\end{array}}}_{j\ne i}{e^{-\eta(R_{ij}-R_s)^2/R_c^2}f_c\left(R_{ij}\right)}.\end{split}\]</div>
<p>The next type is the valence angle symmetry function accounting for three-atom interactions.
Behler valence angle symmetry function is constructed for all triplets of atoms <span class="math">\(i\)</span>,
<span class="math">\(j\)</span>, and <span class="math">\(k\)</span> by summing over the cosine values of the angles
<span class="math">\(\theta_{ijk}=\cos^{-1}\left(\displaystyle\frac{\textbf{R}_{ij}.\textbf{R}_{ik}}{R_{ij}R_{ik}}\right)\)</span>,
(<span class="math">\(\textbf{R}_{ij}=\textbf{R}_{i}-\textbf{R}_{j}\)</span>), centered at atom <span class="math">\(i\)</span>,
according to</p>
<div class="math">
\[\begin{split}{}^{2}G^{(i)}=\displaystyle\frac{2^{1-\zeta}}{3}\sum^{\tiny{\begin{array}{c} \text{atoms j, k within }R_c\\
\text{ distance of atom i}
\end{array}}}_{\scriptsize\begin{array}{c}
j,\,k\ne i \\
(j\ne k) \end{array}}{\left(1+\lambda \cos \theta_{ijk}\right)^\zeta
e^{-\eta\left(R_{ij}^2+R_{ik}^2+R_{jk}^2\right)/R_c^2}\left(f_c\left(R_{ij}\right)+f_c\left(R_{ik}\right)+f_c\left(R_{jk}\right)\right)},\end{split}\]</div>
<p>with parameters <span class="math">\(\lambda\)</span>, <span class="math">\(\eta\)</span>, and <span class="math">\(\zeta\)</span>. The function
<span class="math">\(f_c\left(R_{ij}\right)\)</span> in the above equations is the cutoff function defining the
energetically relevant local environment with value one at <span class="math">\(R_{ij}=0\)</span> and zero at
<span class="math">\(R_{ij}=R_{c}\)</span>, where <span class="math">\(R_c\)</span> is the cutoff radius. In order to have a continuous
force-field, the cutoff function <span class="math">\(f_c\left(R_{ij}\right)\)</span> as well as its first
derivative should be continuous in <span class="math">\(R_{ij}\in\left[0,\infty\right)\)</span>. One possible
expression for such a function as proposed by Behler is</p>
<div class="math">
\[\begin{split}f_{c}\left(R_{ij}\right)==
\begin{cases}
&amp;0.5\left(1+\cos\left(\pi\displaystyle\frac{R_{ij}}{R_c}\right)\right)\qquad \text{for}\;\: R_{ij}\leq R_{c},\\
&amp;0\qquad\qquad\qquad\qquad\quad\quad\quad\:\: \text{for}\;\: R_{ij}&gt; R_{c}.\\
\end{cases}\end{split}\]</div>
<p>Figure below shows how components of fingerprints <span class="math">\({}^{1}\textbf{G}^{(i)}\)</span> and
<span class="math">\({}^{2}\textbf{G}^{(i)}\)</span> change with, respectively, distance <span class="math">\(R_{ij}\)</span> between
pair atoms <span class="math">\(i\)</span> and <span class="math">\(j\)</span> and valence angle <span class="math">\(\theta_{ijk}\)</span> between triplet of
atoms <span class="math">\(i\)</span>, <span class="math">\(j\)</span>, and <span class="math">\(k\)</span> with central atom <span class="math">\(i\)</span>:</p>
<a class="reference internal image-reference" href="_images/fingerprints.png"><img alt="_images/fingerprints.png" class="align-center" src="_images/fingerprints.png" style="width: 811.7px; height: 288.0px;" /></a>
</div>
</div>
<div class="section" id="regression">
<h2>Regression<a class="headerlink" href="#regression" title="Permalink to this headline">¶</a></h2>
<p>The general purpose of the regression operator <span class="math">\(x\xrightarrow{\text{regression}}y\)</span>
with input <span class="math">\(x\)</span> and output <span class="math">\(y\)</span> is to approximate the function <span class="math">\(f\)</span>,
<span class="math">\(y=f(x)\)</span>, where <span class="math">\(f\)</span> may or may not have an explicit functional form, by using
sample train data points <span class="math">\((x_i, y_i)\)</span>. The intent is to later use the approximated
<span class="math">\(f\)</span> for input data <span class="math">\(x_j\)</span> (other than <span class="math">\(x_i\)</span> in the train data set), and
make predictions for <span class="math">\(y_j\)</span>. Typical regression algorithms include, but are not limited
to, Gaussian processes, support vector regression, and neural network.</p>
<div class="section" id="neural-network">
<h3>Neural network<a class="headerlink" href="#neural-network" title="Permalink to this headline">¶</a></h3>
<p>Neural network is basically a very simple model of how the nervous system processes
information. The first mathematical model was developed in 1943 by McCulloch and Pitts [2]
for classification purposes; biological neurons either send or do not send a signal to the
neighboring neuron. The model was soon extended to do linear and nonlinear regression, by
replacing the binary activation function with a continuous function. The basic functional
unit of a neural network is called &#8220;neuron&#8221;. A number of parallel neurons constitute a layer.
A feed-forward neural network consists of at least an input layer plus an output layer.
When approximating the PES, the output layer has just one neuron representing the potential
energy. For a more robust interpolation, a number of &#8220;hidden layers&#8221; may exist in the neural
network as well; the word &#8220;hidden&#8221; refers to the fact that these layers have no physical
meaning. A schematic of a typical feed-forward neural network is shown below. In each neuron
a number of inputs is multiplied by the corresponding weights and summed up with a constant
bias. An activation function then acts upon the summation and an output is generated. The
output is finally sent to the neighboring neuron in the next layer. Typically used
activation functions are hyperbolic tangent, sigmoid, Gaussian, and linear function. The
unbounded linear activation function is particularly useful in the last hidden layer to
scale neural network outputs to the range of reference values. For our purpose, the output
of neural network represents energy of atomic system.</p>
<a class="reference internal image-reference" href="_images/nn.png"><img alt="_images/nn.png" class="align-center" src="_images/nn.png" style="width: 423.3px; height: 266.2px;" /></a>
<p><strong>References:</strong></p>
<ol class="arabic simple">
<li>&#8220;Atom-centered symmetry functions for constructing high-dimensional neural network
potentials&#8221;, J. Behler, J. Chem. Phys. 134(7), 074106 (2011)</li>
<li>&#8220;A logical calculus of the ideas immanent in nervous activity&#8221;, W. S. McCulloch, and W. H.
Pitts, Bull. Math. Biophys. 5, 115&#8211;133 (1943)</li>
</ol>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/amp.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Theory</a><ul>
<li><a class="reference internal" href="#atomic-representation-of-potential-energy">Atomic representation of potential energy</a></li>
<li><a class="reference internal" href="#descriptor">Descriptor</a><ul>
<li><a class="reference internal" href="#behler">Behler</a></li>
</ul>
</li>
<li><a class="reference internal" href="#regression">Regression</a><ul>
<li><a class="reference internal" href="#neural-network">Neural network</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="useamp.html"
                        title="previous chapter">How to use Amp?</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="parallelcomputing.html"
                        title="next chapter">Parallel Computing</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/theory.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="parallelcomputing.html" title="Parallel Computing"
             >next</a> |</li>
        <li class="right" >
          <a href="useamp.html" title="How to use Amp?"
             >previous</a> |</li>
        <li><a href="index.html">AMP 1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, Andrew A. Peterson, Alireza Khorshidi.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>